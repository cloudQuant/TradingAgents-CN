### 背景
现券市场做市报价反映了债券市场的实时供需情况，是债券交易的重要参考数据。

### 任务

建立现券市场做市报价数据集合，获取债券市场的实时做市报价数据。

### 步骤
1. 数据集合：创建一个新的数据集合，名称为**现券市场做市报价** (http://localhost:3000/bonds/collections/bond_spot_quote)
2. 页面功能：数据概览、数据列表、实时刷新
3. 更新数据功能：
   - **实时更新**：支持定时自动刷新
   - **全量获取**：一次性获取所有报价
4. 数据唯一标识：以**报价机构和债券简称**作为唯一标识

### 测试驱动
1. 测试用例文件：`tests/bonds/collections/11_bond_spot_quote_collection.py`

### 验收标准
1. 测试用例能够全部通过
2. 支持实时数据刷新

### 获取数据的API接口、字段等

#### 现券市场做市报价

**接口**: `bond_spot_quote`

**目标地址**: https://www.chinamoney.com.cn/chinese/mkdatabond/

**描述**: 中国外汇交易中心暨全国银行间同业拆借中心-市场数据-市场行情-债券市场行情-现券市场做市报价

**限量**: 单次返回所有数据

**输入参数**

| 名称  | 类型  | 描述  |
|-----|-----|-----|
| -   | -   | -   |

**输出参数**

| 名称    | 类型      | 描述      |
|-------|---------|---------|
| 报价机构  | object  |         |
| 债券简称  | object  |         |
| 买入净价  | float64 | 注意单位: 元 |
| 卖出净价  | float64 | 注意单位: 元 |
| 买入收益率 | float64 | 注意单位: % |
| 卖出收益率 | float64 | 注意单位: % |

**接口示例**

```python
import akshare as ak

bond_spot_quote_df = ak.bond_spot_quote()
print(bond_spot_quote_df)
```

**数据示例**

```
     报价机构       债券简称  买入净价 卖出净价  买入收益率 卖出收益率
0   星展银行(中国)  21进出10  100.34  102.44  3.335  3.0750
1   星展银行(中国)  20农发08  101.88  102.87  2.882  2.5901
```

### 实现要点

1. **后端实现**：
   - 实现报价数据获取
   - 实现实时更新机制
   - 计算买卖价差

2. **前端实现**：
   - 实时数据刷新
   - 价差分析
   - 数据可视化：
     - 报价机构活跃度
     - 买卖价差分布

3. **数据模型**：
   ```python
   {
       "报价机构": str,
       "债券简称": str,
       "买入净价": float,
       "卖出净价": float,
       "买入收益率": float,
       "卖出收益率": float,
       "价差": float,  # 计算得出
       "更新时间": datetime
   }
   ```

### 扩展功能（可选）

1. 价差分析
2. 报价机构对比
3. 收益率曲线

---

## ✅ 实现状态

**状态**: ✅ 已完成后端实现

**完成时间**: 2024-11-23

**实现内容**:
- ✅ 创建测试用例文件：`tests/bonds/collections/11_bond_spot_quote_collection.py`
- ✅ 实现现券市场做市报价数据测试
- ✅ **后端服务层实现**：`BondDataService.save_bond_spot_quote()` 和 `query_bond_spot_quote()`
- ✅ **数据库索引**：报价机构+债券简称联合唯一索引、报价机构索引、债券简称索引、更新时间索引
- ✅ **API端点实现**：
  - `GET /api/bonds/spot-quote` - 查询做市报价数据（支持搜索、筛选、分页、排序）
  - `POST /api/bonds/spot-quote/refresh` - 刷新做市报价数据
- ⏳ 后续需要：前端页面实现

**测试运行**:
```bash
# 运行测试用例
pytest tests/bonds/collections/11_bond_spot_quote_collection.py -v

# 测试API（需要先启动后端服务）
# 查询做市报价
curl -X GET "http://localhost:8000/api/bonds/spot-quote?page=1&page_size=100&organization=星展银行"

# 刷新数据
curl -X POST "http://localhost:8000/api/bonds/spot-quote/refresh"
```

**集合信息**:
- 集合名称：`bond_spot_quote`
- 唯一标识：`报价机构` + `债券简称`（联合主键）
- 数据来源：中国外汇交易中心暨全国银行间同业拆借中心（CFETS）
- API接口：`bond_spot_quote`

**技术实现细节**:
1. 数据模型包含7个字段：报价机构、债券简称、买入净价（元）、卖出净价（元）、买入收益率（%）、卖出收益率（%）、价差（自动计算）
2. 使用联合主键（报价机构+债券简称）确保数据唯一性
3. 自动计算买卖价差：价差 = 卖出净价 - 买入净价
4. 支持按债券简称搜索
5. 支持按报价机构筛选
6. 全量获取：一次性获取所有做市报价数据
7. 实时更新：反映最新的市场做市报价

**数据特点**:
- 做市报价：各报价机构提供的买入卖出双边报价
- 价格信息：包含净价和收益率两个维度
- 市场流动性：反映银行间市场的流动性状况
- 价差分析：买卖价差可用于流动性分析
- 实时性强：数据更新频率较高

**使用场景**:
1. **做市报价监控**：查看各机构对特定债券的报价
2. **流动性分析**：通过买卖价差评估债券流动性
3. **报价机构对比**：对比不同机构的报价水平
4. **套利机会识别**：发现不同机构间的报价差异
5. **收益率分析**：分析买入收益率和卖出收益率

**下一步**:
- 前端页面开发（数据表格、价差分布图、报价机构活跃度）
- 定时任务（实时更新做市报价）
- 价差分析工具（统计平均价差、最大最小价差）
- 报价机构排行（按报价数量、价差大小排序）
- 数据导出功能（Excel、CSV）

### 背景
质押式回购历史数据反映了历史资金面变化，是分析市场资金成本的重要参考。

### 任务

建立质押式回购历史数据集合，获取回购品种的历史行情数据。

### 步骤
1. 数据集合：创建一个新的数据集合，名称为**质押式回购历史数据** (http://localhost:3000/bonds/collections/bond_buy_back_hist_em)
2. 页面功能：数据概览、数据列表、利率走势图
3. 更新数据功能：
   - **单个更新**：输入回购代码，获取历史数据
   - **批量更新**：批量获取多个回购品种的历史数据
4. 数据唯一标识：以**回购代码和日期**作为唯一标识

### 测试驱动
1. 测试用例文件：`tests/bonds/collections/21_bond_buy_back_hist_em_collection.py`

### 验收标准
1. 测试用例能够全部通过
2. 支持利率走势分析

### 获取数据的API接口、字段等

#### 质押式回购历史数据

**接口**: `bond_buy_back_hist_em`

**目标地址**: https://quote.eastmoney.com/center/gridlist.html#bond_sh_buyback

**描述**: 东方财富网-行情中心-债券市场-质押式回购-历史数据

**限量**: 单次返回所有历史行情数据

**输入参数**

| 名称     | 类型  | 描述                       |
|--------|-----|--------------------------|
| symbol | str | symbol="204001"; 质押式回购代码 |

**输出参数**

| 名称  | 类型      | 描述 |
|-----|---------|----|
| 日期  | int64   | -  |
| 开盘  | float64 | -  |
| 收盘  | float64 | -  |
| 最高  | float64 | -  |
| 最低  | float64 | -  |
| 成交量 | float64 | -  |
| 成交额 | float64 | -  |

**接口示例**

```python
import akshare as ak

bond_buy_back_hist_em_df = ak.bond_buy_back_hist_em(symbol="204001")
print(bond_buy_back_hist_em_df)
```

**数据示例**

```
           日期    开盘  收盘    最高    最低        成交量     成交额
0     2006-05-08  1.50  1.500  1.500  1.50         100  1.000000e+05
...
4569  2025-04-03  1.80  1.600  1.815  1.20  1820652598  1.820653e+12
[4570 rows x 7 columns]
```

### 实现要点

1. **后端实现**：
   - 实现历史数据获取
   - 实现批量获取
   - 计算利率统计指标

2. **前端实现**：
   - 利率走势图
   - 波动率分析
   - 数据可视化：
     - 利率时间序列
     - 成交量分析
     - 利率区间统计

3. **数据模型**：
   ```python
   {
       "回购代码": str,
       "日期": str,
       "开盘": float,
       "收盘": float,
       "最高": float,
       "最低": float,
       "成交量": float,
       "成交额": float,
       "更新时间": datetime
   }
   ```

### 扩展功能（可选）

1. 利率季节性分析
2. 资金面预测
3. 历史波动率计算
4. 异常利率检测

---

## ✅ 实现状态

**状态**: ✅ 已完成后端实现

**完成时间**: 2024-11-23

**实现内容**:
- ✅ 后端服务层实现：`save_bond_repo_hist()` 和 `query_bond_repo_hist()`
- ✅ 数据库索引：代码+日期联合唯一索引
- ✅ API端点实现：
  - `GET /api/bonds/repo-hist/{symbol}` - 查询回购历史数据
  - `POST /api/bonds/repo-hist/{symbol}/refresh` - 刷新回购历史数据

**完成率：21/32 = 65.63%** 🎉

# 快速测试指南

## 🚀 5分钟验证所有功能

### 前提条件
1. 前端开发服务器正在运行
2. 后端API服务器正在运行
3. MongoDB数据库已连接

### 测试步骤

#### 测试1：API更新（无参数）- 1分钟

**目标**：验证不需要参数的集合可以直接更新

**步骤**：
```
1. 访问：http://localhost:3000/stocks/collections/stock_zh_a_spot_em
2. 点击"更新数据"下拉菜单
3. 选择"API更新"
4. 选择"更新全部数据"（默认选中）
5. 点击"开始更新"
6. 观察提示消息："刷新任务已启动"
```

**预期结果**：
- ✅ 显示下拉菜单，包含三个选项
- ✅ API更新对话框正常打开
- ✅ 默认选中"更新全部数据"
- ✅ 点击后显示成功消息
- ✅ 页面开始轮询刷新状态

---

#### 测试2：API更新（带参数）- 2分钟

**目标**：验证需要参数的集合可以通过JSON输入参数

**步骤**：
```
1. 访问：http://localhost:3000/stocks/collections/stock_individual_info_em
2. 点击"更新数据" → "API更新"
3. 选择"带参数更新"
4. 在文本框中输入：
   {
     "symbol": "000001"
   }
5. 点击"开始更新"
6. 观察提示消息
```

**预期结果**：
- ✅ 对话框显示JSON输入框
- ✅ 输入JSON后可以提交
- ✅ JSON格式错误时显示错误提示
- ✅ 格式正确时启动刷新任务

**错误测试**：
```
输入无效JSON：
{symbol: "000001"}  （缺少引号）

预期：显示"JSON格式错误，请检查输入"
```

---

#### 测试3：文件导入 - 1分钟

**目标**：验证CSV/Excel文件导入功能

**步骤**：
```
1. 准备一个CSV文件（test_stocks.csv）：
   code,name,price
   000001,平安银行,10.5
   000002,万科A,8.3

2. 访问任意集合页面
3. 点击"更新数据" → "文件导入"
4. 拖拽CSV文件到上传区域
5. 点击"导入"
6. 观察结果
```

**预期结果**：
- ✅ 对话框显示拖拽上传区域
- ✅ 文件拖入后显示文件名
- ✅ 点击导入后显示成功消息
- ✅ 页面数据自动刷新
- ✅ 对话框自动关闭

---

#### 测试4：远程同步（可选）- 1分钟

**目标**：验证远程MongoDB同步功能

**前提**：需要有可访问的远程MongoDB实例

**步骤**：
```
1. 访问任意集合页面
2. 点击"更新数据" → "远程同步"
3. 填写配置：
   - 远程主机：192.168.1.100（你的远程主机）
   - 批次大小：1000
   - 远程集合名：（留空使用当前集合名）
   - 用户名：admin（如果需要）
   - 密码：******（如果需要）
4. 点击"开始同步"
5. 观察同步进度
```

**预期结果**：
- ✅ 对话框显示所有配置项
- ✅ 必填项验证有效
- ✅ 同步完成后显示统计信息
- ✅ 页面数据自动刷新

**注意**：如果没有远程MongoDB，可以跳过此测试

---

## 🎯 验证清单

完成上述测试后，勾选以下项目：

### 基础功能
- [ ] 下拉菜单正常显示（API更新、文件导入、远程同步）
- [ ] 三个对话框都能正常打开
- [ ] 对话框可以正常关闭
- [ ] 对话框样式正常（无错位、无重叠）

### API更新
- [ ] 无参数更新可以正常启动
- [ ] 带参数更新对话框可以切换模式
- [ ] JSON输入框可以正常输入
- [ ] JSON格式验证正常工作
- [ ] 参数成功传递到后端

### 文件导入
- [ ] 拖拽上传区域正常显示
- [ ] 文件可以成功上传
- [ ] 上传后显示成功消息
- [ ] 数据自动刷新

### 远程同步（可选）
- [ ] 配置项完整显示
- [ ] 必填项验证有效
- [ ] 同步功能正常（如果有远程MongoDB）

### 错误处理
- [ ] JSON格式错误有提示
- [ ] 网络错误有提示
- [ ] 后端错误有友好提示

## 🐛 常见问题

### Q1: 点击"更新数据"没有显示下拉菜单
**A**: 检查浏览器控制台是否有错误，可能是图标导入失败。确保`ArrowDown`图标已正确导入。

### Q2: 对话框显示不正常
**A**: 清除浏览器缓存，重新加载页面。确保Element Plus样式已正确加载。

### Q3: API更新没有反应
**A**: 
1. 检查后端服务是否正常运行
2. 打开浏览器控制台查看网络请求
3. 检查后端日志是否有错误

### Q4: 文件导入失败
**A**: 
1. 确认文件格式（CSV或Excel）
2. 确认文件字段名与集合字段匹配
3. 检查文件编码（建议使用UTF-8）

### Q5: JSON参数不知道怎么写
**A**: 参考 `IMPLEMENTATION_COMPLETE.md` 中的参数示例，或查看对应的需求文档。

## ✅ 测试通过标准

全部功能正常时，可以开始标记需求文档为finished：

```powershell
# 示例：标记个股信息查询为完成
Move-Item "tests\stocks\requirements\02_个股信息查询-东财.md" `
          "tests\stocks\requirements\02_个股信息查询-东财-finished.md"
```

## 📸 测试截图建议

如果需要记录测试结果，建议截图：
1. 下拉菜单展开的样子
2. API参数对话框（无参数模式）
3. API参数对话框（带参数模式）
4. 文件导入对话框
5. 远程同步对话框
6. 成功消息提示

---
创建时间：2024-11-24  
预计测试时间：5分钟
